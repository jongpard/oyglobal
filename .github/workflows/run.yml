# Google Drive 업로드
- name: Upload latest CSV to Google Drive
  if: ${{ env.GDRIVE_FOLDER_ID != '' && env.GDRIVE_SERVICE_ACCOUNT_JSON != '' }}
  run: |
    CSV=$(ls -1t data/*.csv 2>/dev/null | head -n1 || true)
    if [ -z "$CSV" ]; then
      echo "No CSV found. Skipping Drive upload."
      exit 0
    fi
    echo "Uploading $CSV to Google Drive folder $GDRIVE_FOLDER_ID"
    python gdrive_upload.py "$CSV"

# Slack 전송
- name: Send Slack Top 10 message
  if: ${{ env.SLACK_WEBHOOK_URL != '' }}
  run: |
    CSV=$(ls -1t data/*.csv 2>/dev/null | head -n1 || true)
    if [ -z "$CSV" ]; then
      echo "No CSV found. Skipping Slack notify."
      exit 0
    fi
    echo "Notifying Slack with $CSV"
    python slack_notify.py "$CSV"
